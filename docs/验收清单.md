# 语音转写小程序 MVP 验收清单

适用范围：
- /Users/zzw/Documents/语音识别/技术路线.md
- /Users/zzw/Documents/语音识别/功能详细设计.md
- /Users/zzw/Documents/语音识别/测试方案.md

验收结论规则：
- 每项必须有“执行结果 + 证据记录（日志/截图/测试报告）”。
- P0 项必须全部通过，方可判定可交付。

---

## 一、功能闭环验收

| 编号 | 验收项 | 步骤 | 通过标准 | 优先级 |
|---|---|---|---|---|
| A-01 | 会话主流程闭环 | 按下热键说话，松开后观察上屏 | 文本成功粘贴，状态回到 `IDLE` | P0 |
| A-02 | 中间态显示 | 录音过程中观察悬浮窗 | 可持续显示 Partial 文本，无明显卡顿 | P1 |
| A-03 | 最终态收尾 | 松键后等待最终结果 | 有 FinalResult 或明确错误提示，不悬挂 | P0 |

---

## 二、权限与异常验收

| 编号 | 验收项 | 步骤 | 通过标准 | 优先级 |
|---|---|---|---|---|
| A-04 | 麦克风权限拒绝 | 关闭权限后触发录音 | 提示可读，授权后可恢复 | P0 |
| A-05 | 辅助功能拒绝 | 关闭辅助功能后触发热键 | 提示可读，授权后可恢复 | P0 |
| A-06 | 鉴权失败 | 设置无效 API Key | 返回 `AUTH_FAILED`，应用不崩溃 | P0 |
| A-07 | 网络中断 | 识别中断网 | 返回 `NETWORK_ERROR` 并回 `IDLE` | P0 |
| A-08 | 协议异常 | 模拟异常响应结构 | 返回 `ASR_PROTOCOL_ERROR` 并清理资源 | P1 |

---

## 三、自动上屏与降级验收

| 编号 | 验收项 | 步骤 | 通过标准 | 优先级 |
|---|---|---|---|---|
| A-09 | 文本粘贴成功 | 在可输入窗口触发识别 | 成功粘贴目标文本 | P0 |
| A-10 | 无输入目标兜底 | 焦点切到桌面后触发上屏 | 返回 `NO_ACTIVE_TARGET`，文本保留剪贴板 | P0 |
| A-11 | 文本剪贴板恢复 | 先复制文本，再执行语音输入 | 语音上屏后，原文本剪贴板恢复 | P1 |
| A-12 | 富媒体恢复边界 | 先复制图片再执行语音输入 | 记录为非 MVP 承诺项，不计失败 | P2 |

---

## 四、稳定性与并发验收

| 编号 | 验收项 | 步骤 | 通过标准 | 优先级 |
|---|---|---|---|---|
| A-13 | 短按稳定性 | 连续 30 次短按 | 无死锁、无重复会话残留 | P0 |
| A-14 | 长按稳定性 | 连续 10 次长按 | 每次仅一次开始/停止，状态一致 | P0 |
| A-15 | 长会话内存控制 | 连续录音至上限附近 | 内存无持续失控增长 | P1 |

---

## 五、测试与覆盖率验收

| 编号 | 验收项 | 步骤 | 通过标准 | 优先级 |
|---|---|---|---|---|
| A-16 | Unit + Integration | 运行 CI 快速集合 | 全部通过 | P0 |
| A-17 | 覆盖率门禁 | 检查测试报告 | 核心逻辑 >= 85% | P0 |
| A-18 | 状态机覆盖 | 检查分支覆盖 | `SessionController` 分支 100% | P0 |
| A-19 | E2E 每日回归 | 运行定时任务 | 关键路径通过且结果可追踪 | P1 |

---

## 六、跨应用实机验收

| 编号 | 验收项 | 步骤 | 通过标准 | 优先级 |
|---|---|---|---|---|
| A-20 | 浏览器输入框 | 在浏览器文本框执行全流程 | 可稳定上屏 | P0 |
| A-21 | 编辑器输入框 | 在编辑器执行全流程 | 可稳定上屏 | P0 |
| A-22 | 输入法兼容 | 中文输入法激活下执行 | 不出现异常候选框干扰粘贴 | P1 |

---

## 七、验收签字

| 角色 | 姓名 | 结果 | 日期 | 备注 |
|---|---|---|---|---|
| 设计评审 |  | 通过 / 不通过 |  |  |
| 开发负责人 |  | 通过 / 不通过 |  |  |
| 测试负责人 |  | 通过 / 不通过 |  |  |

最终判定：P0 全通过后方可进入发布或下一阶段开发。
